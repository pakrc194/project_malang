<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .detail-wrapper {
            max-width: 900px;
            margin: 30px auto;
            padding: 30px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            font-family: Arial, sans-serif;
            line-height: 1.6;
        }

        .detail-wrapper h1, .detail-wrapper h2 {
            text-align: center;
            color: #1f3f6e;
            margin-bottom: 20px;
        }

        .detail-wrapper h2 {
            font-size: 1.2em;
            color: #dc3545; /* 숨김처리 강조 */
        }

        /* --- 공연 기본 정보 영역 (Grid) --- */
        /* Nunjucks 변수들을 깔끔하게 표시하기 위해 Grid 사용 */
        .perf-info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr; /* 2열 레이아웃 */
            gap: 15px 30px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
            padding: 20px;
            border-radius: 6px;
        }
        .perf-info-grid img {
            max-width: 100%;
            height: auto;
            border-radius: 4px;
            display: block;
            /* 포스터와 시놉시스 이미지를 나란히 배치 */
        }
        /* 포스터와 시놉시스 이미지를 감싸는 태그가 없으므로 CSS에서 조정이 제한됨 */
        /* HTML에서 이미지를 <div>로 감싸는 것을 권장합니다. */


        /* --- 캐스팅 목록 (가로 배열) 스타일링 --- */
        .cast-list-container {
            display: flex;
            flex-wrap: wrap; /* 내용이 넘치면 다음 줄로 */
            justify-content: flex-start;
            gap: 20px;
            padding: 20px 0;
            margin-bottom: 30px;
            border-top: 2px solid #5a80d4;
            border-bottom: 1px solid #eee;
            overflow-x: auto; /* 혹시 모를 오버플로우 대비 */
        }

        /* 개별 캐스트 항목 (Nunjucks 루프 내의 출력 결과) */
        .cast-item { 
            /* cast.actor_name, img, cast.cast_name 을 감싸는 <div> 태그를 HTML에 추가한다고 가정합니다. */
            text-align: center;
            min-width: 100px; /* 최소 너비 지정 */
        }

        /* 배우 프로필 이미지 */
        .cast-list-container img {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 50%;
            margin-bottom: 5px;
            border: 3px solid #ccc;
            transition: border-color 0.2s;
        }
        .cast-list-container img:hover {
            border-color: #5a80d4;
        }

        /* 캐스트 이름과 배우 이름 스타일 */
        .cast-item br {
            display: none; /* br 태그 제거 */
        }
        .cast-item p { 
            font-size: 0.9em;
            margin: 0;
            padding: 2px 0;
        }
        .cast-item .actor-name {
            font-weight: bold;
        }
        .cast-item .cast-role {
            color: #777;
        }

        /* --- 스케줄 목록 테이블 스타일 --- */
        .schedule_list table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        .schedule_list th, .schedule_list td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
            vertical-align: middle;
        }

        .schedule_list tr:first-child {
            background-color: #f1f1f1;
            font-weight: bold;
        }

        .schedule_list td img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }

        /* --- 구분선 --- */
        .detail-wrapper hr {
            border: none;
            border-top: 1px solid #ddd;
            margin: 30px 0;
        }
    </style>
</head>
<body>
<div class="detail-wrapper">
    <h1>detail</h1>
    <h2>{% if perfInfo.is_hidden > 0 %}숨김처리{% endif %}</h2>
    
    <div class="perf-info-grid">
        <div>공연명: {{perfInfo.perf_name}}</div>
        
        <div><img src="/img/{{perfInfo.poster_url}}" alt="포스터"></div>
        <div><img src="/img/{{perfInfo.synopsis_url}}" alt="시놉시스"></div>
        
        <div>기간: {{perfInfo.start_date}} ~ {{perfInfo.end_date}}</div>
        <div>장르: {{perfInfo.genre}}</div>
        <div>등록일: {{perfInfo.reg_date}}</div>
        <div>예매상태: {{perfInfo.resv_status}}</div>

        <div style="grid-column: 1 / 3;"> <hr style="margin: 0;"/>
        </div>
        
        <div>공연장: {{venueInfo.venue_name}}</div>
        <div>지역: {{venueInfo.perf_region}}</div>
    </div>
    
    <hr/>
    
    <h3>출연진</h3>
    <div class="cast-list-container">
        {% for cast in perfCast%}
            <div class="cast-item">
                <p class="actor-name">{{cast.actor_name}}</p>
                <img src="/img/{{cast.actor_profile_url}}" alt="{{cast.actor_name}} 프로필">
                <p class="cast-role">({{cast.cast_name}} 역)</p>
            </div>
        {% endfor %}
    </div>
    
    <hr/>
    
    <h3>공연 스케줄 및 캐스팅 정보</h3>
    <div class="schedule_list">
        <table border="0"> <tr>
                <th>날짜</th>
                <th>시간</th>
                <th>회차</th>
                <th>배역 : 배우</th>
                <th>프로필</th>
            </tr>
            {% for schedule in perfScedule %}
                <tr>
                    <td>{{schedule.schedule_date}}</td>
                    <td>{{schedule.schedule_time}}</td>
                    <td>{{schedule.schedule_round}}</td>
                    <td>{{schedule.cast_name}} : {{schedule.actor_name}}</td>
                    <td><img src="/img/{{schedule.actor_profile_url}}" alt="{{schedule.actor_name}} 프로필"></td>
                </tr>
            {% endfor %}
        </table>
    </div>
</div>
</body>
</html>